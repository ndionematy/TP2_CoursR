plot1 = ggplot(dfprop,
aes(x = "", y = freq, fill =var)) +
geom_bar(stat = "identity", width=1) +
coord_polar(theta = "y", start = 0) +
geom_text(aes(label = paste(freq,"%")),color="white",
position = position_stack(vjust=0.5))+
labs(fill = attr(var,"label")) +
theme_void()
# Diagramme en barres avec les effectifs
plot2_eff = ggplot(df,
aes(x = var, y = eff, fill = var)) +
geom_bar(stat = "identity", width=1) +
labs(fill = attr(var,"label")) +
theme(legend.position = "none")
# Diagramme en barres avec les fréquences
plot2_freq = ggplot(dfprop,
aes(x = var, y = freq, fill = var)) +
geom_bar(stat = "identity", width=1) +
labs(fill = attr(var,"label")) +
theme(legend.position = "none")
}
## Variable discrète
else if (is.numeric(var)==TRUE){
# Tri à plat
dftri = data.frame(var)
names(dftri) = "var"
# Tableau des statistiques descriptives (Tendance centrale)
min = min(var, na.rm = TRUE)
q1 = quantile(var, na.rm = TRUE, 0.25)
median = median(var, na.rm = TRUE)
mean = mean(var, na.rm = TRUE)
sd = sd(var, na.rm = TRUE)
variance = sd^2
q3 = quantile(var, na.rm = TRUE, 0.75)
max = max(var, na.rm = TRUE)
stats =  c(min,q1,median,mean,sd,variance,q3,max)
statsLab = c("Minimum", "1er quartile","Médiane",
"Moyenne", "Ecart-type", "Variance",
"3e quartile", "Maximum")
table = data.frame(
Statistiques = statsLab,
Valeurs = stats
)
}
## Sorties : graphiques ou tableaux
if (tab == TRUE){
result = table
expss::xl_write_file(result, "..//Sorties//Tableaux.xlsx")
}
else if(plot == TRUE){
tab = FALSE
if (type == "pie"){
result = plot1
ggsave(filename = name_file, plot = result, path = "..//Sorties//")
}
else{
if(props == FALSE){
result = plot2_eff
ggsave(filename = name_file, plot = result, path = "..//Sorties//")
}
else{
result = plot2_freq
ggsave(filename = name_file, plot = result, path = "..//Sorties//")
}
}
}
else if (plot == TRUE){
tab = FALSE
result = plot2
}
else {result = print("Spécifier les arguments")}
return(result)
}
univarie(base_tp2, age)
univarie(base_tp2, ethnie, plot = TRUE, tab = FALSE, props = TRUE)
univarie <- function(data, var, tab = TRUE, plot=FALSE,type="",
props = TRUE, save = FALSE, *name_file="")
univarie <- function(data, var, tab = TRUE, plot=FALSE,type="",
props = TRUE, save = FALSE, name_file="")
{
## Librairies
library(gtsummary)
library(ggplot2)
library(gt)
library(dplyr)
library(expss)
attach(data)
## Variable qualitative
if (is.character(var)==TRUE | is.factor(var)==TRUE){
# Tableau des effectifs
df = data.frame(table(var))
names(df) = c("var","eff")
# Tableau des fréquences
dfprop = data.frame(round(proportions(table(var))*100,2))
names(dfprop) = c("var","freq")
# Tableau de resultat
table = data.frame(var) |> tbl_summary()
# Diagramme en secteurs
plot1 = ggplot(dfprop,
aes(x = "", y = freq, fill =var)) +
geom_bar(stat = "identity", width=1) +
coord_polar(theta = "y", start = 0) +
geom_text(aes(label = paste(freq,"%")),color="white",
position = position_stack(vjust=0.5))+
labs(fill = attr(var,"label")) +
theme_void()
# Diagramme en barres avec les effectifs
plot2_eff = ggplot(df,
aes(x = var, y = eff, fill = var)) +
geom_bar(stat = "identity", width=1) +
labs(fill = attr(var,"label")) +
theme(legend.position = "none")
# Diagramme en barres avec les fréquences
plot2_freq = ggplot(dfprop,
aes(x = var, y = freq, fill = var)) +
geom_bar(stat = "identity", width=1) +
labs(fill = attr(var,"label")) +
theme(legend.position = "none")
}
## Variable discrète
else if (is.numeric(var)==TRUE){
# Tri à plat
dftri = data.frame(var)
names(dftri) = "var"
# Tableau des statistiques descriptives (Tendance centrale)
min = min(var, na.rm = TRUE)
q1 = quantile(var, na.rm = TRUE, 0.25)
median = median(var, na.rm = TRUE)
mean = mean(var, na.rm = TRUE)
sd = sd(var, na.rm = TRUE)
variance = sd^2
q3 = quantile(var, na.rm = TRUE, 0.75)
max = max(var, na.rm = TRUE)
stats =  c(min,q1,median,mean,sd,variance,q3,max)
statsLab = c("Minimum", "1er quartile","Médiane",
"Moyenne", "Ecart-type", "Variance",
"3e quartile", "Maximum")
table = data.frame(
Statistiques = statsLab,
Valeurs = stats
)
}
## Sorties : graphiques ou tableaux
if (tab == TRUE){
result = table
expss::xl_write_file(result, "..//Sorties//Tableaux.xlsx")
}
else if(plot == TRUE){
tab = FALSE
if (type == "pie"){
result = plot1
ggsave(filename = name_file, plot = result, path = "..//Sorties//")
}
else{
if(props == FALSE){
result = plot2_eff
ggsave(filename = name_file, plot = result, path = "..//Sorties//")
}
else{
result = plot2_freq
ggsave(filename = name_file, plot = result, path = "..//Sorties//")
}
}
}
else if (plot == TRUE){
tab = FALSE
result = plot2
}
else {result = print("Spécifier les arguments")}
return(result)
}
univarie <- function(data, var, tab = TRUE, plot=FALSE,type="",
props = TRUE, save = FALSE, name_file="")
{
## Librairies
library(gtsummary)
library(ggplot2)
library(gt)
library(dplyr)
library(expss)
attach(data)
## Variable qualitative
if (is.character(var)==TRUE | is.factor(var)==TRUE){
# Tableau des effectifs
df = data.frame(table(var))
names(df) = c("var","eff")
# Tableau des fréquences
dfprop = data.frame(round(proportions(table(var))*100,2))
names(dfprop) = c("var","freq")
# Tableau de resultat
table = data.frame(var) |> tbl_summary()
# Diagramme en secteurs
plot1 = ggplot(dfprop,
aes(x = "", y = freq, fill =var)) +
geom_bar(stat = "identity", width=1) +
coord_polar(theta = "y", start = 0) +
geom_text(aes(label = paste(freq,"%")),color="white",
position = position_stack(vjust=0.5))+
labs(fill = attr(var,"label")) +
theme_void()
# Diagramme en barres avec les effectifs
plot2_eff = ggplot(df,
aes(x = var, y = eff, fill = var)) +
geom_bar(stat = "identity", width=1) +
labs(fill = attr(var,"label")) +
theme(legend.position = "none")
# Diagramme en barres avec les fréquences
plot2_freq = ggplot(dfprop,
aes(x = var, y = freq, fill = var)) +
geom_bar(stat = "identity", width=1) +
labs(fill = attr(var,"label")) +
theme(legend.position = "none")
}
## Variable discrète
else if (is.numeric(var)==TRUE){
# Tri à plat
dftri = data.frame(var)
names(dftri) = "var"
# Tableau des statistiques descriptives (Tendance centrale)
min = min(var, na.rm = TRUE)
q1 = quantile(var, na.rm = TRUE, 0.25)
median = median(var, na.rm = TRUE)
mean = mean(var, na.rm = TRUE)
sd = sd(var, na.rm = TRUE)
variance = sd^2
q3 = quantile(var, na.rm = TRUE, 0.75)
max = max(var, na.rm = TRUE)
stats =  c(min,q1,median,mean,sd,variance,q3,max)
statsLab = c("Minimum", "1er quartile","Médiane",
"Moyenne", "Ecart-type", "Variance",
"3e quartile", "Maximum")
table = data.frame(
Statistiques = statsLab,
Valeurs = stats
)
}
## Sorties : graphiques ou tableaux
if (tab == TRUE & save == TRUE){
result = table
expss::xl_write_file(result, "..//Sorties//Tableaux.xlsx")
}
else if(plot == TRUE & save == TRUE){
tab = FALSE
if (type == "pie"){
result = plot1
ggsave(filename = name_file, plot = result, path = "..//Sorties//")
}
else{
if(props == FALSE){
result = plot2_eff
ggsave(filename = name_file, plot = result, path = "..//Sorties//")
}
else{
result = plot2_freq
ggsave(filename = name_file, plot = result, path = "..//Sorties//")
}
}
}
else if (plot == TRUE){
tab = FALSE
result = plot2
}
else {result = print("Spécifier les arguments")}
return(result)
}
univarie(base_tp2, age)
univarie <- function(data, var, tab = TRUE, plot=FALSE,type="",
props = TRUE, save = FALSE, name_file="")
{
## Librairies
library(gtsummary)
library(ggplot2)
library(gt)
library(dplyr)
attach(data)
## Variable qualitative
if (is.character(var)==TRUE | is.factor(var)==TRUE){
# Tableau des effectifs
df = data.frame(table(var))
names(df) = c("var","eff")
# Tableau des fréquences
dfprop = data.frame(round(proportions(table(var))*100,2))
names(dfprop) = c("var","freq")
# Tableau de resultat
table = data.frame(var) |> tbl_summary()
# Diagramme en secteurs
plot1 = ggplot(dfprop,
aes(x = "", y = freq, fill =var)) +
geom_bar(stat = "identity", width=1) +
coord_polar(theta = "y", start = 0) +
geom_text(aes(label = paste(freq,"%")),color="white",
position = position_stack(vjust=0.5))+
labs(fill = attr(var,"label")) +
theme_void()
# Diagramme en barres avec les effectifs
plot2_eff = ggplot(df,
aes(x = var, y = eff, fill = var)) +
geom_bar(stat = "identity", width=1) +
labs(fill = attr(var,"label")) +
theme(legend.position = "none")
# Diagramme en barres avec les fréquences
plot2_freq = ggplot(dfprop,
aes(x = var, y = freq, fill = var)) +
geom_bar(stat = "identity", width=1) +
labs(fill = attr(var,"label")) +
theme(legend.position = "none")
}
## Variable discrète
else if (is.numeric(var)==TRUE){
# Tri à plat
dftri = data.frame(var)
names(dftri) = "var"
# Tableau des statistiques descriptives (Tendance centrale)
min = min(var, na.rm = TRUE)
q1 = quantile(var, na.rm = TRUE, 0.25)
median = median(var, na.rm = TRUE)
mean = mean(var, na.rm = TRUE)
sd = sd(var, na.rm = TRUE)
variance = sd^2
q3 = quantile(var, na.rm = TRUE, 0.75)
max = max(var, na.rm = TRUE)
stats =  c(min,q1,median,mean,sd,variance,q3,max)
statsLab = c("Minimum", "1er quartile","Médiane",
"Moyenne", "Ecart-type", "Variance",
"3e quartile", "Maximum")
table = data.frame(
Statistiques = statsLab,
Valeurs = stats
)
}
## Sorties : graphiques ou tableaux
if (tab == TRUE){result = table}
else if(plot == TRUE){
tab = FALSE
if (type == "pie"){result = plot1}
else{
if(props == FALSE){result = plot2_eff}
else{result = plot2_freq}
}
}
else if (plot == TRUE){
tab = FALSE
result = plot2
}
else {result = print("Spécifier les arguments")}
return(result)
}
bivarie <- function(data, var1, var2, tab=TRUE, plot=FALSE){
library(gtsummary)
library(ggplot2)
attach(df)
## Variable qualitative
if (is.character(var1)==TRUE){
df_plot = data.frame(table(var1, var2))
names(df_plot) = c("Var1","Var2","Freq")
plot = ggplot(df_plot,
aes(x = Var1, y = Freq, fill = Var2)) +
geom_bar(stat = "identity", position = "fill")
table = tbl_cross(df, df$var1, df$var2)
}
## Sorties : graphiques ou tableaux
if (all==TRUE){res = list(table,plot)}
else if(all=="table"){res = table}
else if(all=="plot"){res = plot}
else {res = print("Choisir l'option table ou plot")}
return(res)
}
bivarie( base_tp2, sexe, ethnie)
bivarie <- function(data, var1, var2, tab=TRUE, plot=FALSE){
library(gtsummary)
library(ggplot2)
attach(df)
## Variable qualitative
if (is.character(var1)==TRUE){
df_plot = data.frame(table(var1, var2))
names(df_plot) = c("Var1","Var2","Freq")
plot = ggplot(df_plot,
aes(x = Var1, y = Freq, fill = Var2)) +
geom_bar(stat = "identity", position = "fill")
table = tbl_cross(df, df$var1, df$var2)
}
## Sorties : graphiques ou tableaux
if (all==TRUE){res = list(table,plot)}
else if(all=="table"){res = table}
else if(all=="plot"){res = plot}
else {res = print("Choisir l'option table ou plot")}
return(res)
}
bivarie(base_tp2, sexe, ethnie)
bivarie <- function(data, var1, var2, tab=TRUE, plot=FALSE){
library(gtsummary)
library(ggplot2)
attach(data)
## Variable qualitative
if (is.character(var1)==TRUE){
df_plot = data.frame(table(var1, var2))
names(df_plot) = c("Var1","Var2","Freq")
plot = ggplot(df_plot,
aes(x = Var1, y = Freq, fill = Var2)) +
geom_bar(stat = "identity", position = "fill")
table = tbl_cross(df, df$var1, df$var2)
}
## Sorties : graphiques ou tableaux
if (all==TRUE){res = list(table,plot)}
else if(all=="table"){res = table}
else if(all=="plot"){res = plot}
else {res = print("Choisir l'option table ou plot")}
return(res)
}
bivarie(base_tp2, sexe, ethnie)
bivarie(base_tp2, sexe, ethnie)
bivarie <- function(data, var1, var2, tab=TRUE, plot=FALSE){
library(gtsummary)
library(ggplot2)
attach(data)
## Variable qualitative
if (is.character(var1)==TRUE){
df_plot = data.frame(table(var1, var2))
names(df_plot) = c("Var1","Var2","Freq")
plot = ggplot(df_plot,
aes(x = Var1, y = Freq, fill = Var2)) +
geom_bar(stat = "identity", position = "fill")
table = tbl_cross(df, df$var1, df$var2)
}
## Sorties : graphiques ou tableaux
if (tab = TRUE){res = table}
bivarie <- function(data, var1, var2, tab=TRUE, plot=FALSE){
library(gtsummary)
library(ggplot2)
attach(data)
## Variable qualitative
if (is.character(var1)==TRUE){
df_plot = data.frame(table(var1, var2))
names(df_plot) = c("Var1","Var2","Freq")
plot = ggplot(df_plot,
aes(x = Var1, y = Freq, fill = Var2)) +
geom_bar(stat = "identity", position = "fill")
table = tbl_cross(df, df$var1, df$var2)
}
## Sorties : graphiques ou tableaux
if (tab == TRUE){res = table}
else if(plot == TRUE){res = plot}
else {res = print("Choisir l'option table ou plot")}
return(res)
}
bivarie <- function(data, var1, var2, tab=TRUE, plot=FALSE){
library(gtsummary)
library(ggplot2)
attach(data)
## Variable qualitative
if (is.character(var1)==TRUE){
df_plot = data.frame(table(var1, var2))
names(df_plot) = c("Var1","Var2","Freq")
plot = ggplot(df_plot,
aes(x = Var1, y = Freq, fill = Var2)) +
geom_bar(stat = "identity", position = "fill")
table = tbl_cross(df, df$var1, df$var2)
}
## Sorties : graphiques ou tableaux
if (tab == TRUE){res = table}
else if(plot == TRUE){res = plot}
else {res = print("Choisir l'option table ou plot")}
return(res)
}
bivarie(base_tp2, sexe, ethnie)
bivarie <- function(data, var1, var2, tab=TRUE, plot=FALSE){
library(gtsummary)
library(ggplot2)
attach(data)
## Variable qualitative
if (is.character(var1)==TRUE){
df_plot = data.frame(table(var1, var2))
names(df_plot) = c("Var1","Var2","Freq")
plot = ggplot(df_plot,
aes(x = Var1, y = Freq, fill = Var2)) +
geom_bar(stat = "identity", position = "fill")
table = tbl_cross(df, df$var1, df$var2)
}
## Sorties : graphiques ou tableaux
if (tab == TRUE){res = table}
else if(plot == TRUE){res = plot}
else {res = print("Choisir l'option table ou plot")}
return(res)
}
bivarie(base_tp2, sexe, ethnie)
bivarie(base_tp2, sexe, ethnie, tab = TRUE)
bivarie(base_tp2, sexe, ethnie, tab = TRUE)[1]
bivarie(base_tp2, sexe, ethnie, tab = TRUE)
bivarie(base_tp2, sexe, ethnie, all=TRUE)
univarie(base_tp2, sexe, plot = TRUE, tab = FALSE, props = TRUE, type="pie")
bivarie(base_tp2, sexe, ethnie)
bivarie <- function(df, var1, var2, all=TRUE){
library(gtsummary)
library(ggplot2)
attach(df)
## Variable qualitative
if (is.character(var1)==TRUE){
df_plot = data.frame(table(var1, var2))
names(df_plot) = c("Var1","Var2","Freq")
plot = ggplot(df_plot,
aes(x = Var1, y = Freq, fill = Var2)) +
geom_bar(stat = "identity", position = "fill")
table = tbl_cross(df, df$var1, df$var2)
}
## Sorties : graphiques ou tableaux
if (all==TRUE){res = list(table,plot)}
else if(all=="table"){res = table}
else if(all=="plot"){res = plot}
else {res = print("Choisir l'option table ou plot")}
return(res)
}
bivarie(base_tp2, sexe, ethnie)[[1]]
