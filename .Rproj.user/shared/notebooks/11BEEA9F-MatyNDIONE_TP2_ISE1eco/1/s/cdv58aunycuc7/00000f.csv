"0","univarie <- function(data, var, tab = TRUE, plot=FALSE, type=""""){"
"0","  library(gtsummary)"
"0","  library(ggplot2)"
"0","  attach(data)"
"0","  "
"0","  ## Variable qualitative"
"0","    if (is.character(var)==TRUE | is.factor(var)){"
"0","      df = data.frame(table(var))"
"0","      names(df) = c(""var"",""eff"")"
"0","      table = data.frame(var) |> tbl_summary()"
"0","      "
"0","      plot1 = ggplot(df, "
"0","                aes(x = """", y = eff, fill = var)) +"
"0","              geom_bar(stat = ""identity"", width=1) +"
"0","              coord_polar(theta = ""y"", start = 0) +"
"0","              geom_text(aes(label = eff),color=""white"", "
"0","                        position = position_stack(vjust=0.5))+"
"0","              theme_void()"
"0","      "
"0","      plot2 = ggplot(df, "
"0","                aes(x = var, y = eff, fill = var)) +"
"0","              geom_bar(stat = ""identity"", width=1) + "
"0","              theme(legend.position = ""none"")"
"0","    }"
"0","  "
"0","  ## Variable discrète"
"0","  else if (is.numeric(var)==TRUE){"
"0","      table = as.data.frame(summary(data.frame(var)))['Freq']"
"0","  }"
"0","  "
"0","  ## Sorties : graphiques ou tableaux"
"0","  if (tab==TRUE){res = table} "
"0","  else if(plot==TRUE){res = plot1}"
"0","  else if(plot==TRUE){"
"0","      if(type==""bar""){res = plot2}"
"0","      }"
"0","  else {res = print(""Spécifier les arguments plot ou table"")}"
"0","  "
"0","  return(res)"
"0","}"
