"0","univarie <- function(data, var, tab = TRUE, plot=FALSE,type="""", "
"0","                     props = TRUE, save = FALSE, name_file="""")"
"0","  {"
"0",""
"0","  ## Librairies"
"0","  library(gtsummary)"
"0","  library(ggplot2)"
"0","  library(gt)"
"0","  library(dplyr)"
"0","  attach(data)"
"0","  "
"0","  ## Variable qualitative"
"0","    if (is.character(var)==TRUE | is.factor(var)==TRUE){"
"0","      "
"0","      # Tableau des effectifs"
"0","      df = data.frame(table(var))"
"0","      names(df) = c(""var"",""eff"")"
"0",""
"0","      # Tableau des fréquences"
"0","      dfprop = data.frame(round(proportions(table(var))*100,2))"
"0","      names(dfprop) = c(""var"",""freq"")"
"0","      "
"0","      # Tableau de resultat"
"0","      table = data.frame(var) |> tbl_summary()"
"0","      "
"0","      # Diagramme en secteurs"
"0","      plot1 = ggplot(dfprop, "
"0","                aes(x = """", y = freq, fill =var)) +"
"0","              geom_bar(stat = ""identity"", width=1) +"
"0","              coord_polar(theta = ""y"", start = 0) +"
"0","              geom_text(aes(label = paste(freq,""%"")),color=""white"", "
"0","                        position = position_stack(vjust=0.5))+"
"0","              labs(fill = attr(var,""label"")) +"
"0","              theme_void() "
"0","      "
"0","      # Diagramme en barres avec les effectifs"
"0","      plot2_eff = ggplot(df, "
"0","                aes(x = var, y = eff, fill = var)) +"
"0","              geom_bar(stat = ""identity"", width=1) + "
"0","              labs(fill = attr(var,""label"")) +"
"0","              theme(legend.position = ""none"")"
"0","      "
"0","      # Diagramme en barres avec les fréquences"
"0","      plot2_freq = ggplot(dfprop, "
"0","                aes(x = var, y = freq, fill = var)) +"
"0","              geom_bar(stat = ""identity"", width=1) + "
"0","              labs(fill = attr(var,""label"")) + "
"0","              theme(legend.position = ""none"")"
"0","    }"
"0","  "
"0","  ## Variable discrète"
"0","  else if (is.numeric(var)==TRUE){"
"0","    "
"0","      # Tri à plat"
"0","      dftri = data.frame(var)"
"0","      names(dftri) = ""var"""
"0","      "
"0","      # Tableau des statistiques descriptives (Tendance centrale)"
"0","      min = min(var, na.rm = TRUE)"
"0","      q1 = quantile(var, na.rm = TRUE, 0.25)"
"0","      median = median(var, na.rm = TRUE)"
"0","      mean = mean(var, na.rm = TRUE)"
"0","      sd = sd(var, na.rm = TRUE)"
"0","      variance = sd^2"
"0","      q3 = quantile(var, na.rm = TRUE, 0.75)"
"0","      max = max(var, na.rm = TRUE)"
"0","      stats =  c(min,q1,median,mean,sd,variance,q3,max)"
"0","      statsLab = c(""Minimum"", ""1er quartile"",""Médiane"","
"0","                   ""Moyenne"", ""Ecart-type"", ""Variance"","
"0","                   ""3e quartile"", ""Maximum"")"
"0","      table = data.frame("
"0","        Statistiques = statsLab,"
"0","        Valeurs = stats"
"0","      )"
"0","  }"
"0","  "
"0","  ## Sorties : graphiques ou tableaux"
"0","  if (tab == TRUE){result = table} "
"0","  "
"0","  else if(plot == TRUE){"
"0","    tab = FALSE"
"0","    if (type == ""pie""){result = plot1}"
"0","    else{"
"0","      if(props == FALSE){result = plot2_eff}"
"0","      else{result = plot2_freq}"
"0","      }"
"0","  }"
"0","  "
"0","  else if (plot == TRUE){"
"0","    tab = FALSE"
"0","    result = plot2"
"0","  }"
"0","  else {result = print(""Spécifier les arguments"")}"
"0","  "
"0","  return(result)"
"0","}"
